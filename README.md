# uniset2-viewer-go

Веб-сервер для мониторинга состояния uniset2 процессов, отслеживания изменений внутренних переменных во времени с отображением графиков.

## Возможности

- Получение списка доступных uniset2 объектов
- Просмотр внутренних переменных объекта в реальном времени
- Графики для аналоговых и дискретных величин (Chart.js)
- Хранение истории: in-memory или SQLite
- Единый исполняемый файл (веб-ресурсы встроены через go:embed)

## Установка

```bash
go build -o uniset2-viewer ./cmd/server
```

## Запуск

```bash
./uniset2-viewer [опции]
```

### Параметры

| Параметр | По умолчанию | Описание |
|----------|--------------|----------|
| `--uniset-url` | `http://localhost:8080` | Адрес uniset2 HTTP API |
| `--port` | `8000` | Порт веб-сервера |
| `--poll-interval` | `5s` | Интервал опроса uniset2 |
| `--storage` | `memory` | Тип хранилища: `memory` или `sqlite` |
| `--sqlite-path` | `./history.db` | Путь к SQLite базе данных |
| `--history-ttl` | `1h` | Время хранения истории |

### Примеры

```bash
# Базовый запуск
./uniset2-viewer --uniset-url http://192.168.1.100:8080

# С SQLite хранилищем
./uniset2-viewer --uniset-url http://192.168.1.100:8080 --storage sqlite --sqlite-path /var/lib/uniset-viewer/history.db

# С кастомным интервалом опроса
./uniset2-viewer --uniset-url http://192.168.1.100:8080 --poll-interval 2s
```

## Архитектура

```
┌─────────────────────────────────────────────────────────────┐
│                      Browser (HTML/JS)                      │
│  ┌──────────────┐  ┌──────────────────────────────────────┐ │
│  │ Список       │  │ Вкладка объекта                      │ │
│  │ объектов     │  │ - таблица переменных                 │ │
│  │              │  │ - графики Chart.js                   │ │
│  └──────────────┘  └──────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                 uniset2-viewer-go (Go Server)               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │ HTTP Server │  │ UniSet      │  │ Storage             │  │
│  │ (REST API)  │  │ Client      │  │ (memory/sqlite)     │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                  UniSet2 процессы (HTTP API)                │
│   /api/v01/list          - список объектов                  │
│   /api/v01/{Object}      - данные объекта                   │
│   /api/v01/{Object}/help - доступные команды                │
└─────────────────────────────────────────────────────────────┘
```

## Структура проекта

```
uniset2-viewer-go/
├── cmd/server/main.go       # точка входа
├── internal/
│   ├── config/              # конфигурация
│   ├── uniset/              # HTTP клиент к uniset2
│   ├── storage/             # хранилище истории
│   ├── poller/              # периодический опрос
│   └── api/                 # REST API сервера
├── ui/
│   ├── embed.go             # go:embed директивы
│   ├── static/              # JS, CSS
│   └── templates/           # HTML шаблоны
├── go.mod
└── README.md
```

## Лицензия

MIT
